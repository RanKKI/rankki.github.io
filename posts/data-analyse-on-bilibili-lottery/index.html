<!doctype html><html lang=zh-cn><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>对于 Bilibili 抽奖的数据分析 | RanKKI's Blog</title>
<link rel=canonical href=https://rankki.xyz/posts/data-analyse-on-bilibili-lottery/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:url" content="https://rankki.xyz/posts/data-analyse-on-bilibili-lottery/"><meta property="og:site_name" content="RanKKI's Blog"><meta property="og:title" content="对于 Bilibili 抽奖的数据分析"><meta property="og:description" content="最近开始深入数据分析的坑，虽然在学了 FIT1043，但这门课是第一年的课，加上比较水 (但又是必修课)， 就没有学到东西，最近闲来无事，正好在哔哩哔哩参加了@毕导 THU的抽奖， 并且有 33 个名额，所以想着来做一次分析。"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-06-06T12:07:37+00:00"><meta property="article:modified_time" content="2021-09-18T18:42:24+08:00"><meta property="article:tag" content="DataAnalysis"><meta property="article:tag" content="Bilibili"><meta name=twitter:card content="summary"><meta name=twitter:title content="对于 Bilibili 抽奖的数据分析"><meta name=twitter:description content="最近开始深入数据分析的坑，虽然在学了 FIT1043，但这门课是第一年的课，加上比较水 (但又是必修课)， 就没有学到东西，最近闲来无事，正好在哔哩哔哩参加了@毕导 THU的抽奖， 并且有 33 个名额，所以想着来做一次分析。"><link rel=stylesheet href=https://rankki.xyz/css/styles.703587cbc83e3d6c4abb083f3126cd73c5c67af0782c70bbc9e4643c1d171ec879a51fed1fd12cf82e0469fc4c2454f83d63696957494d2268aa2cc691a4ef06.css><link rel=stylesheet href=https://rankki.xyz/css/syntax.css><link rel=stylesheet href=https://rankki.xyz/css/loading.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://rankki.xyz/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><header id=header><a href=https://rankki.xyz/><div id=title><h1>RanKKI's Blog</h1></div></a><div id=nav><ul><li class=icon><a href=# aria-label=Menu><i class="fas fa-bars fa-2x" aria-hidden=true></i></a></li><li><a href=/>Home</a></li><li><a href=/about>About</a></li><li><a href=/tags>Tags</a></li></ul></div></header><div id=header-post><span id=menu><div id=toc><nav id=TableOfContents><ul><li><a href=#分析-api>分析 API</a></li><li><a href=#数据清理>数据清理</a></li></ul><ul><li><a href=#数据定义>数据定义</a><ul><li><a href=#prize_users-数据详情>prize_users 数据详情</a></li><li><a href=#all_users-数据详情>all_users 数据详情</a></li></ul></li><li><a href=#数据分析>数据分析</a><ul><li><a href=#用户等级分布>用户等级分布</a></li><li><a href=#大会员占比>大会员占比</a></li><li><a href=#转发时间>转发时间</a></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">对于 Bilibili 抽奖的数据分析</h1><div class=meta><div class=postdate><time datetime="2020-06-06 12:07:37 +0000 UTC" itemprop=datePublished>2020-06-06</time>
(Updated: <time datetime="2021-09-18 18:42:24 +0800 CST" itemprop=dateModified>2021-09-18</time>)</div><div class=article-read-time><i class="far fa-clock"></i>
8 minute read</div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/dataanalysis rel=tag>DataAnalysis</a>
,
<a class=tag-link href=/tags/bilibili rel=tag>Bilibili</a></div></div></header><div class=content itemprop=articleBody><p>最近开始深入数据分析的坑，虽然在学了 FIT1043，但这门课是第一年的课，加上比较水 (但又是必修课)，
就没有学到东西，最近闲来无事，正好在哔哩哔哩参加了<code>@毕导 THU</code>的抽奖， 并且有 33 个名额，所以想着来做一次分析。</p><blockquote><p>声明下，以下分析均为个人观点。并且数据仅供学习使用</p></blockquote><h1 id=前期准备>前期准备</h1><h2 id=分析-api>分析 API</h2><p>首先，需要获取数据，在抽奖动态页面中进行抓包，可以看到一个对<code>/lottery_notice</code>的请求，查看内容可以看到所有中奖用户的 uid,</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;code&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;data&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;first_prize&#34;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;second_prize&#34;</span><span class=p>:</span> <span class=mi>10</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;third_prize&#34;</span><span class=p>:</span> <span class=mi>20</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;lottery_result&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;first_prize_result&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;uid&#34;</span><span class=p>:</span> <span class=mi>21696250</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Alan 婪&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;face&#34;</span><span class=p>:</span> <span class=s2>&#34;https://i1.hdslb.com/bfs/face/d03761481bdf0adec61e876a56309c1e2e444721.jpg&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;second_prize_result&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;uid&#34;</span><span class=p>:</span> <span class=mi>17660688</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;城西吖吖&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;face&#34;</span><span class=p>:</span> <span class=s2>&#34;https://i1.hdslb.com/bfs/face/798c3f5751c934df20af1cb60b1ec7ba8e05f318.jpg&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;third_prize_result&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;uid&#34;</span><span class=p>:</span> <span class=mi>4134700</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;weacho&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;face&#34;</span><span class=p>:</span> <span class=s2>&#34;https://i0.hdslb.com/bfs/face/9280e500dba7cf754c9e82e3428a3192de64e47c.jpg&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;first_prize_cmt&#34;</span><span class=p>:</span> <span class=s2>&#34;iPad Air 3 64G&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;second_prize_cmt&#34;</span><span class=p>:</span> <span class=s2>&#34;Kindle 青春版&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;third_prize_cmt&#34;</span><span class=p>:</span> <span class=s2>&#34;100 元现金红包&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>以及，打开用户动态，可以看到另一个请求<code>/space_history</code>，这个 API 返回了，用户的信息和发送、转发的动态。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;code&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;msg&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;message&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;data&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;has_more&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;attentions&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;uids&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=err>...</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;cards&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;desc&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;uid&#34;</span><span class=p>:</span> <span class=mi>21696250</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;rid&#34;</span><span class=p>:</span> <span class=mi>397377349256764900</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;acl&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;view&#34;</span><span class=p>:</span> <span class=mi>2552</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;repost&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;comment&#34;</span><span class=p>:</span> <span class=mi>21</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;like&#34;</span><span class=p>:</span> <span class=mi>8</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;is_liked&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;dynamic_id&#34;</span><span class=p>:</span> <span class=mi>397377349254099260</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=err>...</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;card&#34;</span><span class=p>:</span> <span class=s2>&#34;{ \&#34;user\&#34;: { \&#34;uid\&#34;: 21696250, \&#34;uname\&#34;: \&#34;Alan 婪\&#34;, \&#34;face\&#34;: \&#34;</span><span class=err>https</span><span class=p>:</span><span class=err>\\/\\/i</span><span class=mi>1</span><span class=err>.hdslb.com\\/bfs\\/face\\/d</span><span class=mi>03761481</span><span class=err>bd</span>
</span></span><span class=line><span class=cl>            <span class=err>...</span>
</span></span></code></pre></td></tr></table></div></div><p>接着获取转发抽奖动态所有人的信息</p><blockquote><p>which 不太可能，一共有 18.7 万人转发，借口最多给 640 人，但我看了下数据，动态是 2020-05-27 18:02:12 发送的，第一个非<code>@毕导 THU</code>转发是 2020-05-27 18:07:38，最后一个转发 2020-06-06 13:36:59，所以可以当作 sample 使用 (么？)</p><p>但是，我发现评论接口没有限制，大概有 1.6 万人的评论，因为这是个抽奖动态，可以认定评论的人都参与了转发 (即抽奖)，于是可以爬取评论，然后进行对比</p></blockquote><h2 id=数据清理>数据清理</h2><p>然后需要进行数据清理，通过获奖的 api，可以提取出所有用户的 uid,</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>list</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nb>map</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s2>&#34;uid&#34;</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>        <span class=n>reduce</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=k>lambda</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>            <span class=n>data</span><span class=p>[</span><span class=s2>&#34;data&#34;</span><span class=p>][</span><span class=s2>&#34;lottery_result&#34;</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>以及将用户信息和发送、转发的动态提取出来</p><blockquote><p>在这里，我只提取了我认为可能会有影响的因素</p><p>class <code>Card</code> 是转发和回复的内容</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>uid</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>level</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>vip_type</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>vip_status</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>uid</span> <span class=o>=</span> <span class=n>uid</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>level</span> <span class=o>=</span> <span class=n>level</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>vip_type</span> <span class=o>=</span> <span class=n>vip_type</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>vip_status</span> <span class=o>=</span> <span class=n>vip_status</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Card</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>content</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>timestamp</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>origin</span><span class=p>:</span> <span class=n>Card</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=nb>id</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>user</span><span class=p>:</span> <span class=n>User</span> <span class=o>=</span> <span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>content</span> <span class=o>=</span> <span class=n>content</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>timestamp</span> <span class=o>=</span> <span class=n>timestamp</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>origin</span> <span class=o>=</span> <span class=n>origin</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>id</span> <span class=o>=</span> <span class=nb>id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user</span> <span class=o>=</span> <span class=n>user</span>
</span></span></code></pre></td></tr></table></div></div><p>随后，将信息写入 csv 文件，以便之后使用 pandas 进行分析</p><h1 id=分析>分析</h1><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=n>prize_users</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;./prize_users.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>all_users</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;./all_other_users.csv&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><code>prize_users</code>是中奖用户，<code>all_users</code>是<del>所有</del>参与的用户，(因为接口问题，无法获取所有用户，同时评论有 1.6 万人，但因为<del>懒</del>怕被 ban ip 只先获取了 1.2 万人)</p><p><code>all_users</code> 不包括发布抽奖的 up 主本人</p></blockquote><h2 id=数据定义>数据定义</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>prize_users</span><span class=o>.</span><span class=n>head</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><table><thead><tr><th>uid</th><th>level</th><th>vip_type</th><th>vip_status</th><th>time_after</th></tr></thead><tbody><tr><td>21696250</td><td>5</td><td>0</td><td>0</td><td>1767</td></tr><tr><td>29332457</td><td>5</td><td>1</td><td>0</td><td>580531</td></tr><tr><td>94078703</td><td>5</td><td>2</td><td>1</td><td>5347</td></tr><tr><td>17660688</td><td>5</td><td>0</td><td>0</td><td>63184</td></tr><tr><td>22417036</td><td>5</td><td>1</td><td>1</td><td>15013</td></tr></tbody></table><ul><li>uid，用户的 b 站 id</li><li>level，用户等级</li><li>time_after，在抽奖动态发送多少秒后转发的。</li></ul><p>对于 vip_type 和 vip_status，通过<code>openbilibili</code>的<code>/app/admin/main/vip/model/vip.go</code>中可以看到这项数值的定义。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=c1>// const vip enum value
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>const</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>NotVip</span>    <span class=p>=</span> <span class=mi>0</span> <span class=c1>//非大会员
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>Vip</span>       <span class=p>=</span> <span class=mi>1</span> <span class=c1>//月度大会员
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>AnnualVip</span> <span class=p>=</span> <span class=mi>2</span> <span class=c1>//年度会员
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>	<span class=nx>VipStatusOverTime</span>    <span class=p>=</span> <span class=mi>0</span> <span class=c1>//过期
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>VipStatusNotOverTime</span> <span class=p>=</span> <span class=mi>1</span> <span class=c1>//未过期
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>VipStatusFrozen</span>      <span class=p>=</span> <span class=mi>2</span> <span class=c1>//冻结
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>VipStatusBan</span>         <span class=p>=</span> <span class=mi>3</span> <span class=c1>//封禁
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=o>...</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=prize_users-数据详情>prize_users 数据详情</h3><table><thead><tr><th></th><th>uid</th><th>level</th><th>vip_type</th><th>vip_status</th><th>time_after</th></tr></thead><tbody><tr><td>count</td><td>3.300000e+01</td><td>33.000000</td><td>33.000000</td><td>33.000000</td><td>33.000000</td></tr><tr><td>mean</td><td>1.632111e+08</td><td>4.484848</td><td>0.909091</td><td>0.484848</td><td>313364.333333</td></tr><tr><td>std</td><td>1.724799e+08</td><td>0.870388</td><td>0.842750</td><td>0.507519</td><td>320576.262967</td></tr><tr><td>min</td><td>4.134700e+06</td><td>2.000000</td><td>0.000000</td><td>0.000000</td><td>281.000000</td></tr><tr><td>25%</td><td>2.525509e+07</td><td>4.000000</td><td>0.000000</td><td>0.000000</td><td>3331.000000</td></tr><tr><td>50%</td><td>4.962842e+07</td><td>5.000000</td><td>1.000000</td><td>0.000000</td><td>199071.000000</td></tr><tr><td>75%</td><td>2.941396e+08</td><td>5.000000</td><td>2.000000</td><td>1.000000</td><td>597423.000000</td></tr><tr><td>max</td><td>5.098047e+08</td><td>6.000000</td><td>2.000000</td><td>1.000000</td><td>812534.000000</td></tr></tbody></table><h3 id=all_users-数据详情>all_users 数据详情</h3><table><thead><tr><th></th><th>uid</th><th>level</th><th>vip_type</th><th>vip_status</th><th>time_after</th></tr></thead><tbody><tr><td>count</td><td>1.263000e+04</td><td>12630.000000</td><td>12630.000000</td><td>12630.000000</td><td>12630.000000</td></tr><tr><td>mean</td><td>2.243269e+08</td><td>3.829295</td><td>0.542280</td><td>0.236817</td><td>250477.374822</td></tr><tr><td>std</td><td>1.743140e+08</td><td>0.999087</td><td>0.726571</td><td>0.425146</td><td>289099.261204</td></tr><tr><td>min</td><td>1.300000e+01</td><td>1.000000</td><td>0.000000</td><td>0.000000</td><td>212.000000</td></tr><tr><td>25%</td><td>3.654792e+07</td><td>3.000000</td><td>0.000000</td><td>0.000000</td><td>10677.750000</td></tr><tr><td>50%</td><td>2.382717e+08</td><td>4.000000</td><td>0.000000</td><td>0.000000</td><td>59733.500000</td></tr><tr><td>75%</td><td>3.855455e+08</td><td>5.000000</td><td>1.000000</td><td>0.000000</td><td>583955.000000</td></tr><tr><td>max</td><td>6.022326e+08</td><td>6.000000</td><td>2.000000</td><td>1.000000</td><td>852418.000000</td></tr></tbody></table><h2 id=数据分析>数据分析</h2><h3 id=用户等级分布>用户等级分布</h3><p><img src=https://i.loli.net/2020/06/06/krzh17HwDS3Zonv.png alt=用户等级分布></p><p>左边的是得奖用户的等级划分，右边则是所有用户的等级。</p><p>得奖用户中的 5 级账号是明显多余其他等级的，占总共的 50% 以上。</p><p>并且中奖用户的平均等级是 4.48，而所有用户等级的平均数是在 3.82, (std 相差 .129)，即中奖用户等级偏高。</p><h3 id=大会员占比>大会员占比</h3><p><img src=https://i.loli.net/2020/06/06/AJfYIUdthxDqwTX.png alt=大会员状态></p><p><img src=https://i.loli.net/2020/06/06/GPU9LYDjoXWplkq.png alt=大会员类型></p><p>可以看到得奖用户的大会员状态占比基本持平，但可以看到没有大会员的用户是有大会员用户数的 3 倍，即大会员会对抽奖结果造成影响 (特殊加成)，但是，年度大会员和月度大会员似乎没有特殊加成</p><h3 id=转发时间>转发时间</h3><p><img src=https://i.loli.net/2020/06/06/3Go5mUpDOalEjey.png alt=转发时间></p><p>X轴是以<code>小时</code>为单位的，即转发时间为抽奖动态发布的 x 小时</p><p>中奖用户转发的时间和大部分用户发帖的时间基本一致，</p><p><img src=https://i.loli.net/2020/06/06/9LJQfmAEZ1OrcDo.png alt="前 5 个小时转发"></p><p>但在这<code>前 5 个小时转发</code>的图里，可以看到有 11 个 (33%) 中奖用户的转发时间是在前 2 个小时，似乎在抽奖动态发出后半个小时和一个小时间转发的中奖率更大。</p><h1 id=结论>结论</h1><blockquote><p><del>怀疑</del>(不用怀疑) 数据有缺失，导致结果不准</p></blockquote><p>就如我文章前头说的，都是个人观点，因为只是学习使用，分析啥的都很渣。</p><p>但通过这些数据，得出的结论是，大会员会有特殊加成，前 2 个小时转发也会有加成 (大概).</p></div></article><footer id=footer><div class=footer-left>Copyright &copy; 2024 Hugh(Hui) Liu</div><script src=https://code.iconify.design/2/2.0.4/iconify.min.js></script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "7f02cdd7074d4e1f8125c11651f47699"}'></script></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script></html>