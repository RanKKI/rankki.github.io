<!doctype html><html lang=zh-cn><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Hack DTTV100 机顶盒 | RanKKI's Blog</title>
<link rel=canonical href=https://rankki.xyz/posts/hack-dttv100/><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:url" content="https://rankki.xyz/posts/hack-dttv100/"><meta property="og:site_name" content="RanKKI's Blog"><meta property="og:title" content="Hack DTTV100 机顶盒"><meta property="og:description" content="背景 联通给了个 IPTV 机顶盒， 看了下是 Android 4.4 系统的，在 Google 一圈之后，发现有人是通过硬件 hack 拿到权限的。但实际上这个机顶盒里面自带一个商店，需要下载， 那只要来个中间人替换应用市场的 apk 就行了。然后正好手上有个树莓派，（虽然说不用也行。 ）
开始 hack 准备硬件 树莓派（刷好系统的） 网线 Wi-Fi 适配器（Pi3 可以忽略） 测试软件 树莓派设置好 Wi-Fi 连接， 安装 FruityWifi，并设置好 in(eth0) 和 out(wlan0),
out 是树莓派和 AP 连接的， in 则是等下和机顶盒连接。
之后安装 bettercap 或者其他类似的软件，可以嗅 http 连接的。
监听 打开机顶盒，进入，并且把下载好的应用市场卸载掉。 使用 bettercap Duang！链接出来了。 可以看到有一个 http 的 get 请求，
http://210.12.0.175:7084/launcher/data/1254621050/DSMClient20180727.apk
替换文件 随后在 Fruity Wifi 里把 eth0 的地址设置成 210.12.0.175，就像下图
之后 ssh 登陆到树莓派，新建一个/launcher/data/1254621050 目录，然后把其他应用市场的文件放进去并重命名为DSMClient20180727.apk
并用 Python 也好，其他语言框架也好，在目录上搭建一个 file server，并设置端口为 7084"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-12-27T17:36:21+00:00"><meta property="article:modified_time" content="2021-09-18T18:42:24+08:00"><meta property="article:tag" content="MITM"><meta name=twitter:card content="summary"><meta name=twitter:title content="Hack DTTV100 机顶盒"><meta name=twitter:description content="背景 联通给了个 IPTV 机顶盒， 看了下是 Android 4.4 系统的，在 Google 一圈之后，发现有人是通过硬件 hack 拿到权限的。但实际上这个机顶盒里面自带一个商店，需要下载， 那只要来个中间人替换应用市场的 apk 就行了。然后正好手上有个树莓派，（虽然说不用也行。 ）
开始 hack 准备硬件 树莓派（刷好系统的） 网线 Wi-Fi 适配器（Pi3 可以忽略） 测试软件 树莓派设置好 Wi-Fi 连接， 安装 FruityWifi，并设置好 in(eth0) 和 out(wlan0),
out 是树莓派和 AP 连接的， in 则是等下和机顶盒连接。
之后安装 bettercap 或者其他类似的软件，可以嗅 http 连接的。
监听 打开机顶盒，进入，并且把下载好的应用市场卸载掉。 使用 bettercap Duang！链接出来了。 可以看到有一个 http 的 get 请求，
http://210.12.0.175:7084/launcher/data/1254621050/DSMClient20180727.apk
替换文件 随后在 Fruity Wifi 里把 eth0 的地址设置成 210.12.0.175，就像下图
之后 ssh 登陆到树莓派，新建一个/launcher/data/1254621050 目录，然后把其他应用市场的文件放进去并重命名为DSMClient20180727.apk
并用 Python 也好，其他语言框架也好，在目录上搭建一个 file server，并设置端口为 7084"><link rel=stylesheet href=https://rankki.xyz/css/styles.703587cbc83e3d6c4abb083f3126cd73c5c67af0782c70bbc9e4643c1d171ec879a51fed1fd12cf82e0469fc4c2454f83d63696957494d2268aa2cc691a4ef06.css><link rel=stylesheet href=https://rankki.xyz/css/syntax.css><link rel=stylesheet href=https://rankki.xyz/css/loading.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://rankki.xyz/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><header id=header><a href=https://rankki.xyz/><div id=title><h1>RanKKI's Blog</h1></div></a><div id=nav><ul><li class=icon><a href=# aria-label=Menu><i class="fas fa-bars fa-2x" aria-hidden=true></i></a></li><li><a href=/>Home</a></li><li><a href=/about>About</a></li><li><a href=/tags>Tags</a></li></ul></div></header><div id=header-post><span id=menu><div id=toc><nav id=TableOfContents><ul><li><ul><li><a href=#背景>背景</a></li><li><a href=#开始-hack>开始 hack</a></li><li><a href=#hack>Hack!</a></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Hack DTTV100 机顶盒</h1><div class=meta><div class=postdate><time datetime="2018-12-27 17:36:21 +0000 UTC" itemprop=datePublished>2018-12-27</time>
(Updated: <time datetime="2021-09-18 18:42:24 +0800 CST" itemprop=dateModified>2021-09-18</time>)</div><div class=article-read-time><i class="far fa-clock"></i>
2 minute read</div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/mitm rel=tag>MITM</a></div></div></header><div class=content itemprop=articleBody><h3 id=背景>背景</h3><p>联通给了个 IPTV 机顶盒， 看了下是 Android 4.4 系统的，在 Google 一圈之后，发现有人是通过硬件 hack 拿到权限的。但实际上这个机顶盒里面自带一个商店，需要下载， 那只要来个中间人替换应用市场的 apk 就行了。然后正好手上有个树莓派，（虽然说不用也行。 ）</p><h3 id=开始-hack>开始 hack</h3><h4 id=准备硬件>准备硬件</h4><ul><li>树莓派（刷好系统的）</li><li>网线</li><li>Wi-Fi 适配器（Pi3 可以忽略）</li></ul><h4 id=测试软件>测试软件</h4><p>树莓派设置好 Wi-Fi 连接， 安装 FruityWifi，并设置好 in(eth0) 和 out(wlan0),</p><p>out 是树莓派和 AP 连接的， in 则是等下和机顶盒连接。</p><p><img src=https://i.loli.net/2018/12/27/5c24bdf1128a0.png alt="Fruity Wifi"></p><p>之后安装 bettercap 或者其他类似的软件，可以嗅 http 连接的。</p><h4 id=监听>监听</h4><ul><li>打开机顶盒，进入，并且把下载好的应用市场卸载掉。</li><li>使用 bettercap</li><li>Duang！链接出来了。</li></ul><p><img src=https://i.loli.net/2018/12/27/5c24bec1d2b30.png alt="IPTV Market URL"></p><p>可以看到有一个 http 的 get 请求，</p><p><code>http://210.12.0.175:7084/launcher/data/1254621050/DSMClient20180727.apk</code></p><h4 id=替换文件>替换文件</h4><p>随后在 Fruity Wifi 里把 eth0 的地址设置成 210.12.0.175，就像下图</p><p><img src=https://i.loli.net/2018/12/27/5c24bdf1128a0.png alt="Fruity Wifi"></p><p>之后 ssh 登陆到树莓派，新建一个<code>/launcher/data/1254621050</code> 目录，然后把其他应用市场的文件放进去并重命名为<code>DSMClient20180727.apk</code></p><p>并用 Python 也好，其他语言框架也好，在目录上搭建一个 file server，并设置端口为 7084</p><h3 id=hack>Hack!</h3><p>打开机顶盒，并点击应用市场，这时候看树莓派那边的 file server 就能看到一个 get 记录，等待一会，进入应用列表就能发现，已经安装好了</p></div></article><footer id=footer><div class=footer-left>Copyright &copy; 2024 Hugh(Hui) Liu</div><script src=https://code.iconify.design/2/2.0.4/iconify.min.js></script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "7f02cdd7074d4e1f8125c11651f47699"}'></script></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script></html>